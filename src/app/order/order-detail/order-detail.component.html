<div class="{{login_data.view_dashboard=='1' ? 'main-container':'main-container'}}">

    <div *ngIf="loader">
        <mat-spinner class="loader">
            <div>
                <p>Loading....</p>
            </div>
        </mat-spinner>
    </div>
    <div class="middle-container">
        <div class="page-heading">
            <div class="heading-text bc-space">
                <div class="back-btn" (click)="back()">
                    <a mat-button><i class="material-icons">arrow_right_alt</i></a>
                </div>
                <h2>Order Detail</h2>
            </div>
        </div>

        <div class="left-auto">
            <!-- <button mat-raised-button color="accent" class="mr15" color="accent"
            *ngIf="(login_data.access_level == '1' && order_detail.delivery_from=='Gravity') && order_detail.order_status=='Pending' "
            (click)="addmoreitem()">
            Add More Items
        </button> -->
            <button mat-raised-button color="accent" class="mr15" color="accent"
                *ngIf="(login_data.access_level == '1' && order_detail.delivery_from=='Gravity') && order_detail.order_status=='Pending' && edit_field == true"
                (click)="openDialog()">
                Change Status
            </button>

            <button mat-raised-button color="accent" class="mr15" color="accent"
                *ngIf="order_detail.order_status == 'PDispatch' && login_data.access_level == '1'" (click)="closeOrder()">
                Close Order
            </button>

            <div class="action-menu">

                <button mat-raised-button color="accent" class="ml10" (click)="open_dipatch_model()"
                    *ngIf="order_detail.order_status=='Approved' || order_detail.order_status=='PDispatch'">
                    Dispatch Item
                </button>

                <!-- <button mat-raised-button color="accent" class="ml10"   (click)="changeStatusToDispatch(order_detail.id)" *ngIf="order_detail.disp_qty !=0 && order_detail.order_status!='Dispatch' &&( order_detail.order_status=='readyToDispatch'|| order_detail.order_status=='PDispatch')">
                        Dispatch Order
                    </button>
                    <button mat-raised-button color="accent" class="ml10"   [disabled]="order_detail.disp_qty != '0'"  (click)="alert()" *ngIf="order_detail.disp_qty ==0 && order_detail.order_status!='Dispatch' &&( order_detail.order_status=='readyToDispatch'|| order_detail.order_status=='PDispatch')">
                        Dispatch Order
                    </button> -->

                <button *ngIf = "order_detail.printEnabled" class="ml10" mat-raised-button color="primary" (click)="downloadOrderNote()">Print</button>

                <!-- <div class="action-menu">

                        <mat-menu #menu="matMenu" class="drop-down-menu">
                            <button mat-menu-item (click)="downloadOrderPdf('with_image')">
                                <span>Download With Image</span>
                            </button>
                            <button mat-menu-item (click)="downloadOrderPdf('without_image')">
                                <span>Download Without Image</span>
                            </button>
                        </mat-menu>
                    </div> -->

            </div>
        </div>
    </div>


    <div class="container-outer">
        <div class="container">

            <div class="row">
                <div class="col s4">
                    <div class="details-info">
                        <div class="basic-details">
                            <div class="cs-heading" >
                                <h2>Order Details</h2>
                            </div>
                            <div class="cs-figure" >
                                <ul>
                                    <li  style="min-width: 87px;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span> Date</span>
                                                <p>{{order_detail.date_created | date:' d MMM , y'}}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li >
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Order ID</span>
                                                <p>{{order_detail.order_no}}</p>
                                            </div>
                                        </div>
                                    </li>

                                    <li *ngIf="order_detail.order_status=='Reject'">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Reason Of Reject</span>
                                                <p>{{order_detail.reason_reject}}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li *ngIf="order_detail.order_status=='Approved'">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Approved By</span>
                                                <p>{{order_detail.approved_by_name}}</p>
                                            </div>
                                        </div>
                                    </li>

                                </ul>

                                <ul class="mt10">
                                    <li  *ngIf="order_detail.created_by_type != 'channel partner'">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Created By</span>
                                                <p>{{order_detail.created_by_name}}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li  style="min-width: 130px;" >
                                        <div class="outer" >
                                            <div class="inner">
                                                <span>Status</span>
                                                <p>

                                                    <ng-container *ngIf="order_detail.order_status == 'Pending'">
                                                        Pending
                                                    </ng-container>
                                                    <ng-container *ngIf="order_detail.order_status == 'Accept'">
                                                        Accepted
                                                    </ng-container>
                                                    <ng-container *ngIf="order_detail.order_status == 'Approved'">
                                                        Order Accepted
                                                    </ng-container>

                                                    <ng-container *ngIf="order_detail.order_status == 'PDispatch'">
                                                        Partially Dispatched
                                                    </ng-container>
                                                    <ng-container *ngIf="order_detail.order_status == 'Dispatch'">
                                                        Completely Dispatched
                                                    </ng-container>
                                                    <ng-container *ngIf="order_detail.order_status == 'Closed'">
                                                        Closed
                                                    </ng-container>
                                                    <ng-container *ngIf="order_detail.order_status == 'Reject' || order_detail.order_status == 'Rejected'">
                                                        Reject
                                                    </ng-container>

                                                </p>
                                            </div>
                                        </div>
                                    </li>
                                    <!-- <li style="border: 1px solid #B29D9D;" *ngIf="order_detail.remark">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Accepted Remark</span>
                                                <p *ngIf="order_detail.remark">{{order_detail.remark}}</p>
                                            </div>
                                        </div>
                                    </li> -->

                                    <li style="border: 1px solid #B29D9D;" *ngIf="order_detail.order_remark">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Order Remark</span>
                                                <p>{{order_detail.order_remark}}</p>
                                            </div>
                                        </div>
                                    </li>


                                </ul>
                            </div>
                        </div>
                    </div>


                </div>

                <div class="col s4">

                    <div class="details-info">
                        <div class="basic-details">
                            <div class="cs-heading">
                                <h2 *ngIf="order_detail.delivery_from=='Gravity'">Dealer Detail</h2>
                                <h2 *ngIf="order_detail.delivery_from!='Gravity'">Retail Partner Detail</h2>
                            </div>
                            <div class="cs-figure">
                                <ul>
                                    <li>
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Company <span class="dashicons dashicons-nametag"></span></span>
                                                <p>
                                                    {{order_detail.dr_name}}
                                                </p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="w200" style="min-width: 200px;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>GST No.</span>
                                                <p>{{order_detail.gst ? order_detail.gst : 'N/A'}}</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <ul  class="mt10">
                                    <li>
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Contact Person <span class="dashicons dashicons-nametag"></span></span>
                                                <p>
                                                    {{order_detail.name ?order_detail.name:'--' }}
                                                </p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="w200" style="min-width: 200px;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Contact No.</span>
                                                <p>{{order_detail.party_mobile ? order_detail.party_mobile : 'N/A'}}</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <ul class="mt10" *ngIf="order_detail.outstanding_balance && order_detail.overdue_balance">
                                    <li style="background-color:#5b8f21;">
                                        <div class="outer" >
                                            <div class="inner">
                                                <span style="color: #fff;">Outstanding <span class="dashicons dashicons-nametag"></span></span>
                                                <p style="color: #fff;">
                                                  &#8377;  {{order_detail.outstanding_balance }}
                                                </p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="w200" style="min-width: 200px; background-color: #FF0000;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span style="color: #fff;">Overdue</span>
                                                <p style="color: #fff;"> &#8377; {{order_detail.overdue_balance}}</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <ul class="mt10"  *ngIf="order_detail.outstanding_balance && order_detail.overdue_balance">
                                    <li class=""  style="min-width: 200px; background-color: #56026b;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span style="color: #fff;">Overdue Days</span>
                                                <p style="color: #fff;">{{order_detail.overdue_days}}</p>
                                            </div>
                                        </div>
                                    </li>

                                </ul>
                                <ul class="mt10">
                                    <li style="border: 1px solid #B29D9D;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Address</span>
                                                <p>{{order_detail.address ? order_detail.address : 'N/A'}}
                                                    {{order_detail.city ? ', '+ order_detail.city : ''}}
                                                    {{order_detail.district ? ', '+order_detail.district : ''}}
                                                    {{order_detail.state ? ', '+order_detail.state : ''}}</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>



                </div>
                <div class="col s4">
                    <div class="details-info ">
                        <div class="basic-details" >
                            <div class="cs-heading">
                                <h2>Upload Document</h2>
                            </div>
                            <div class="cs-file">
                                <ul class="product-images">
                                    <li class="multi-images">

                                        <label class="cs-file-img" *ngFor="let val of order_doc_data; let i = index">
                                            <img [src]="val.doc" alt="your image" (click)="imageModel(val.doc)">
                                            <span class="cancel-icon">
                                                <a class="close"><i class="material-icons dp48"
                                                        (click)="delete_img(val.id)">clear</i></a>
                                            </span>
                                        </label>

                                        <label class="cs-file-img default">
                                            <i class="material-icons">cloud_upload</i>
                                            <input type="file" name="image" placeholder="Upload file"
                                                accept=".png,.jpg,.jpeg" multiple style="display: none;"
                                                (change)="insertImage($event)">
                                                <!-- <div class="alert alert-danger" *ngIf="this.msg">
                                                  only 2mb file is required....
                                                </div> -->
                                        </label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt25">
                <div class="col s12">
                    <div class="cs-collapse">
                        <!-- <mat-accordion class="example-headers-align">

                                <mat-expansion-panel>

                                    <mat-expansion-panel-header>
                                        <mat-panel-title> -->
                        <h2 style="display: inline-block;
                                            padding: 10px;
                                            border-radius: 0px 20px 20px 0px;
                                            margin-bottom: 14px; background-color:#275478;
                                            font-size: 13px;
                                            letter-spacing: 0.16em;
                                            line-height: 15px;
                                            text-align: left;
                                            text-transform: uppercase;
                                            color: #fff">
                            Order Items
                        </h2>

                        <!-- </mat-panel-title>
                                    </mat-expansion-panel-header> -->

                        <div class="collapse-body pt0">
                            <div class="cs-form">

                                <div class="cs-table left-right-20">
                                    <div class="table-head">
                                        <table class="sno-border">
                                            <tr>
                                                <th class="w40 text-center"></th>
                                                <th class="w40 text-center"></th>
                                                <th >Product Description</th>
                                                <th class="w80">Panel Code</th>
                                                <!-- <th class="w130">Stock Availability</th> -->
                                                <th class="w100">Discontinue</th>
                                                <th class="w80">QTY</th>
                                                <th class="w80">Stock Quantity</th>

                                                <th class="w100">Dispatch Qty</th>

                                                <th class="w95">Pending Qty</th>
                                                <th class="w80">MRP</th>
                                                <th class="w90">Sub-Total</th>
                                                <!-- <th class="w110">Discount</th> -->
                                                <th class="w90 text-right"> Amount</th>
                                                <th class="w90">Status</th>

                                            </tr>
                                        </table>
                                    </div>

                                    <div class="table-container">
                                        <div class="table-content">
                                            <table class="sno-border">
                                                <tr *ngFor="let list of order_item; let i=index">
                                                    <td class="w40 text-center">{{i+1}}</td>
                                                    <td class="w40 text-center">
                                                        <mat-checkbox
                                                            *ngIf="list.order_item_status == 'Pending' && order_detail.order_status != 'Closed'"
                                                            (change)="update_status_itemwise_method($event,list.id)">
                                                        </mat-checkbox>
                                                        <mat-checkbox *ngIf="list.order_item_status == 'Approved' || order_detail.order_status == 'Closed'"
                                                            [disabled]=true [indeterminate]=true></mat-checkbox>
                                                    </td>
                                                    <td >{{list.brand}} {{list.product_name}} </td>
                                                    <td class="w80">{{list.panel_code ?list.panel_code:'--'}} </td>
                                                    <!-- <td class="w130"  [ngClass]="  list.stock_status== 'Out Of Stock' && list.stock_incoming_days != '0000-00-00' ? 'stock-alert' : 'stock-green'" >{{ list.stock_status== 'Out Of Stock' && list.stock_incoming_days && list.stock_incoming_days != '' && list.stock_incoming_days != '0000-00-00' ?(list.stock_incoming_days | date:' d MMM y') :'Available'}} <br> {{ list.stock_status== 'Out Of Stock' && list.stock_incoming_days && list.stock_incoming_days != '' && list.stock_incoming_days != '0000-00-00' && today_date <= list.stock_incoming_days? (date_diff(today_date,list.stock_incoming_days) == 1? '('+date_diff(today_date,list.stock_incoming_days)+' Day)' : '('+date_diff(today_date,list.stock_incoming_days)+' Days)')  :''}}</td> -->
                                                    <!-- <td class="w80" *ngIf="(order_detail.order_status=='Pending')"> -->
                                                    
                                                    <td class="w100">{{list.status_code == 'DIS' || list.status_code == 'DIS AIM' || list.status_code == 'WRONG' || list.status_code == 'NONE' || list.status_code == 'LAX' || list.status_code == 'MTO' ? 'Yes':'No'}}</td>

                                                    <td class="w80" *ngIf="(list.order_item_status=='Pending' && order_detail.order_status != 'Closed')">
                                                        <div class="td-input" [ngClass]="{'active':list.editqty==true}">
                                                            <input type="number" class="input-bdr" value="{{list.qty}}"
                                                                name="qty" #qty="ngModel" [(ngModel)]="list.qty"
                                                                (ngModelChange)="calc(list.id,list.qty)"
                                                                [readonly]="!list.editqty" onkeypress="return event.charCode>=48 && event.charCode<=57" min="1">
                                                            <div class="edit">
                                                                <a class="edit-icon edit"
                                                                    *ngIf="list.editqty == false"><i
                                                                        class="material-icons"
                                                                        (click)="list.editqty = true">create</i></a>
                                                                <a class="edit-icon save"
                                                                    *ngIf="list.editqty == true"><i
                                                                        class="material-icons"
                                                                        (click)="list.editqty = false;update_order(list.id)">save</i></a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <!-- <td class="w100">
                                                        <div class="acton-btn">
                                                            <a  class="view" mat-button  (click)="view_order_item(list.id,list.brand)">
                                                              <i class="material-icons">remove_red_eye</i>

                                                            </a>
                                                            <a *ngIf="view_edit" mat-button class="view" (click)="userDetail(list.id)"><i class="material-icons">remove_red_eye</i> View</a>
                                                            <button *ngIf="view_delete" mat-button class="delete" (click)="deleteUser(list.id)"><i class="material-icons">delete_sweep</i> Delete</button>
                                                          </div>
                                                    </td> -->
                                                    <!-- <td class="w80"*ngIf="(order_detail.order_status!='Pending' || list.order_item_status == 'Approved')"> -->
                                                    <td class="w80"*ngIf="(list.order_item_status!='Pending' || list.order_item_status == 'Approved' || list.order_item_status == 'Reject' || order_detail.order_status == 'Closed')">
                                                        {{list.qty}}</td>
                                                    <td class="w80">{{list.stock_qty}}</td>

                                                    <td class="w100">{{list.dispatch_qty && list.dispatch_qty != 'null' ? list.dispatch_qty : 0 }}</td>
                                                    <td class="w95">{{list.pending_qty ? list.pending_qty : 0 }}</td>
                                                    <td class="w80"> 
                                                        <span *ngIf="list.price != '0'">
                                                            &#8377; 
                                                        </span>
                                                       
                                                        {{list.price == '0' ? '--':list.price}}</td>
                                                    <td class="w90">
                                                        <span *ngIf="list.sub_total != '0'">
                                                            &#8377; 
                                                        </span>
                                                       
                                                         {{list.sub_total == '0' ? '--':list.sub_total}}</td>
                                                    <!-- <td class="w110 ">&#8377; {{list.discount_amount * list.qty |
                                                        number:'1.0-3'}}({{list.discount_percent}}%)</td> -->
                                                    <td class="w90 text-right">
                                                        <span *ngIf="list.amount != '0'">
                                                            &#8377; 
                                                        </span>
                                                         
                                                        {{list.amount == '0' ? '--':list.amount }}</td>
                                                    <td class="w90">{{list.order_item_status =='PDispatch'? 'Partially Dispatch':list.order_item_status}}</td>
                                                    <!-- <td class="w90">
                                                        <span *ngIf="list.order_item_status == 'Pending'" style="background-color: #ffcd7b; padding: 16px 16px 16px 18px; border-radius: 5px;font-weight: bold">{{list.order_item_status}}</span>
              <span *ngIf="list.order_item_status == 'Draft'" class="draft" style="color: #000;  padding: 16px 16px 16px 18px; border-radius: 5px; font-weight: bold">{{list.order_item_status}}</span>
              <span *ngIf="list.order_item_status == 'Approved'" style="background-color: #8aff67;  padding: 16px 16px 16px 18px; margin: 0px 0px 0px -9px; border-radius: 5px; font-weight: bold">Accepted</span>
              <span *ngIf="list.order_item_status == 'Reject'" style="background-color: #ff0000;color: #ffffff; padding: 16px 16px 16px 18px; border-radius: 5px; font-weight: bold">{{list.order_item_status}}</span>
              <span *ngIf="list.order_item_status == 'PDispatch'" style="background-color: #488aff;padding: 10px 11px 10px 27px; margin: 2px 2px 2px -9px;
              border-radius: 0px 6px 0px 0px; color:#fff; font-weight: bold">Partially Dispatch</span>
              <span *ngIf="list.order_item_status == 'Dispatch'" style="background-color: #488aff;  padding: 10px 11px 10px 27px; margin: 2px 2px 2px -9px;
              border-radius: 0px 6px 0px 0px; color:#fff; font-weight: bold">{{list.order_item_status}}</span>
                                                    </td> -->
                                                </tr>
                                            </table>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>

                        <!-- </mat-expansion-panel> -->

                        <mat-expansion-panel *ngIf="false && dispatched_box_detail.length">

                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    Dispatch Items Detail
                                </mat-panel-title>
                            </mat-expansion-panel-header>

                            <div class="collapse-body pt0">
                                <div class="cs-form">

                                    <div class="cs-table left-right-20">
                                        <div class="table-head">
                                            <table class="sno-border">
                                                <tr>
                                                    <th class="w40 text-center"></th>
                                                    <th class="w100">Date Created</th>
                                                    <th>User Name</th>
                                                    <th class="w150 text-center">Master Code</th>
                                                    <th class="w150 text-center">Total Item (Master)</th>
                                                    <th class="w130 text-center">Total Box Packing</th>
                                                    <th class="w100">View Details</th>
                                                </tr>
                                            </table>
                                        </div>

                                        <div class="table-container">
                                            <div class="table-content">
                                                <table class="sno-border">
                                                    <tr
                                                        *ngFor="let dispatch_data of dispatched_box_detail; let i=index">
                                                        <td class="w40 text-center"></td>
                                                        <td class="w100">{{dispatch_data.dispatch_on | date : 'd MMM,
                                                            y'}}</td>
                                                        <td>{{dispatch_data.dispatch_by_username | titlecase}}</td>
                                                        <td class="w150 text-center">
                                                            {{dispatch_data.master_box_qr_code}}</td>
                                                        <td class="w150 text-center">{{dispatch_data.total_item_qty}}
                                                        </td>
                                                        <td class="w130 text-center">
                                                            {{dispatch_data.total_secondary_box_packing}}</td>
                                                        <td class="w100 text-center">
                                                            <a style="cursor: pointer"
                                                                (click)="view_dispatch_item_details(dispatch_data.id)"
                                                                class="ankr-clr">View</a>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </mat-expansion-panel>
                        <!-- </mat-accordion> -->
                    </div>
                </div>
            </div>


            <div class="row">
                <div class="col s8">
                    <div class="details-info"
                        *ngIf="order_detail.delivery_from!='Gravity' && order_billing_details.length > 0">
                        <div class="basic-details">
                            <div class="cs-heading">
                                <h2>Invoice Details</h2>
                            </div>
                            <div class="cs-figure" *ngFor="let details of order_billing_details">
                                <ul class="h80"
                                    *ngIf="(details.bill_image && details.bill_image!= '' ) || (details.bill_amount && details.bill_amount!= '')">
                                    <li style="min-width: 100px;">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>Date of Invoice</span>
                                                <p>{{details.date_created | date:' d MMM , y , hh:mm aa'}}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li *ngIf="details.bill_amount && details.bill_amount!= ''">
                                        <div class="outer">
                                            <div class="inner">
                                                <span>BILL AMOUNT (Before GST)</span>
                                                <p>&#8377; {{details.bill_amount }}</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li w200 *ngIf="details.bill_image && details.bill_image!= ''">
                                        <div class="outer">
                                            <div class="inner">

                                                <a class="img-avtar w60 h60">
                                                    <img src="{{details.bill_image && details.bill_image == ''? 'assets/img/NoPopNGift.png':details.bill_image}}"
                                                        (click)="details.bill_image && details.bill_image != '' ? imageModel(details.bill_image): ''">
                                                </a>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col s4">
                    <div class="invoice-table">
                        <table>

                            <tr>
                                <td>Total Qty</td>
                                <td class="w30 text-center">:</td>
                                <td class="w200 text-right "> {{order_detail.total_item_qty}}</td>
                            </tr>


                            <tr>
                                <td>Sub Amount</td>
                                <td class="w30 text-center">:</td>
                                <td class="w200 text-right ">&#8377; {{order_detail.sub_total}}</td>
                            </tr>
                            <tr>
                                <td>Discount</td>
                                <td class="text-center">:</td>
                                <td class="text-right ">&#8377; {{order_detail.order_discount}}</td>
                            </tr>
                            <tr>
                                <td>Net Total</td>
                                <td class="text-center">:</td>
                                <td class="text-right ">&#8377; {{order_detail.order_total}}</td>
                            </tr>

                            <tr *ngIf="order_detail.sp_type">
                                <td *ngIf="order_detail.sp_type=='Discount'">Special Discount</td>
                                <td *ngIf="order_detail.sp_type=='Premium'">Additional Charges</td>
                                <td class="text-center">:</td>
                                <td class="text-right ">&#8377; {{order_detail.special_discount_amount}}</td>
                            </tr>


                            <tr>
                                <td>Grand Total</td>
                                <td class="text-center">:</td>
                                <td class="text-right ">&#8377; {{order_detail.order_grand_total}}</td>
                            </tr>
                            <tr>
                                <td>Breakup of Grand Total</td>
                                <td class="text-center">:</td>
                                <td class="text-right ">(&#8377;{{order_detail.netBreakup}},GST(18%) :
                                    &#8377;{{order_detail.gstBreakup}}) </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="details-info padding0 mt10" *ngIf="order_detail.order_status_change_log.length > 0">
                <h2 style="display: inline-block; padding: 10px; border-radius: 0px 20px 20px 0px; margin-bottom: 14px; background-color:#275478; font-size: 13px; letter-spacing: 0.16em;line-height: 15px;text-align: left;text-transform: uppercase;color: #fff">Orders Log </h2>

                <div class="cs-table">
                    <div class="table-head">
                        <!-- <table class="sno-border"> -->
                            <table class="">
                            <tr>
                                <th class="w20">S.No</th>
                                <th class="w40">Updated On</th>

                                <th class="w30">Updated By</th>
                                <th class="w40">Action</th>
                                <th class="w40">Product Description</th>

                                <th class="w150">Remark</th>
                            </tr>
                        </table>
                    </div>

                    <div class="table-container">
                        <div class="table-content" style="word-break: break-all;">
                            <!-- <table class="sno-border"  > -->
                            <table class=""  >

                                <tr *ngFor="let k of order_detail.order_status_change_log; let i=index">
                                    <td class="w20">{{i+1}}</td>
                                    <td class="w40">{{k.changed_time | date:' d MMM y, h:mm a'}} </td>

                                    <td class="w30">{{k.usr_name }}</td>
                                    <!-- <td*ngIf="() " class="w40">
                                         </td*ngIf=> -->
                                    <td class="w40">{{k.changed_status == 'Reject'? 'Reject':k.changed_status == 'Dispatch'?'Dispatched':k.changed_status == 'Approved'?'Order Accepted':k.changed_status == 'Pending'? 'Pending':k.changed_status == 'PDispatch' ? 'Partially Dispatched': k.changed_status == 'Closed' ? 'Order Closed':'--'}}</td>
                                    <!-- <td  class="w40"></td>
                                    <td  class="w40">
                                    </td>
                                    <td *ngIf="()" class="w40"></td> -->
                                    <td class="w40">{{k.order_item_name ? k.order_item_name:'--'}}</td>
                                    <td class="w150">{{k.reason ? k.reason :'--'}} </td>
                                </tr>
                            </table>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>



</div>

<div class="h50"></div>


<!DOCTYPE html>
<html id="printDataWithImage" style="display:none" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <div style="width: 1024px; margin: 0 auto; font-family: Arial, Helvetica, sans-serif;">
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">
            <tr>
                <td style="vertical-align: top; padding: 5px; text-align: center;">
                    <div>

                        <img src="assets/img/logo.jpeg" alt="Logo" style="height: 70px;">
                    </div>
                </td>
                <td style="vertical-align: top; padding: 5px; text-align: right;" colspan="2">
                    <div>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Address:-</strong>28/3/2,
                            Site IV Industrial Area, Sahibabad, Ghaziabad, Uttar Pradesh 201001</p>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Contact Us:-</strong>+91-
                            86-87-300-400</p>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>E-Mail
                                Address:-</strong>info@gravitybath.com</p>
                    </div>
                </td>
            </tr>
            <tr>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline; ">
                        Order Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Date:-</strong>
                        {{order_detail.date_created | date :' dd/MM/yyyy'}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Order
                            ID:-</strong>{{order_detail.order_no}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Status:-</strong> Pending</p>


                </td>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline;">
                        Dealer Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Company Name & Type:-</strong>
                        {{order_detail.dr_name}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>GST
                            NO.:-</strong>{{order_detail.gst ? order_detail.gst : 'N/A'}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;">
                        <strong>Address:-</strong>{{order_detail.address ? order_detail.address : 'N/A'}}
                        {{order_detail.city ? ', '+ order_detail.city : ''}} {{order_detail.district ? ',
                        '+order_detail.district : ''}} {{order_detail.state ? ', '+order_detail.state : ''}}</p>
                </td>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline;">
                        Transport Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Transporter
                            Name:-</strong>{{!order_detail.transport_name ? ' N/A ' : order_detail.transport_name |
                        titlecase }}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Mobile
                            No:-</strong>{{!order_detail.transport_mobile ? ' N/A ' : order_detail.transport_mobile }}
                    </p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;">
                        <strong>Address:-</strong>{{!order_detail.transport_address ? ' N/A ' :
                        order_detail.transport_address | titlecase }} </p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Private
                            Marka:-</strong>{{!order_detail.private_marka ? ' N/A ' : order_detail.private_marka |
                        titlecase }}</p>
                </td>
            </tr>
            <tr>
                <td colspan="3" style="padding:10px; background: #cccccc; font-size: 14px; font-weight: 600;">Order
                    Detail</td>
            </tr>
        </table>
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">

            <tr>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: center;">Product Image</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: left;">Product Description
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 60px;">QTY</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 100px;">Dispatch QTY.</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 80px;">Rate
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 100px;">Sub
                    Total</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 120px;text-align: left;">Discount
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 120px;text-align: left;">Net Rate
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 110px;">Amount
                </th>
            </tr>

            <tr *ngFor="let list of order_item; let i=index">



                <td
                    style="font-size: 14px; padding: 4px; text-align: center; vertical-align: top;width:90px;border: 1px solid #000">
                    <img src="{{list.item_images}}" style="max-width: 100%;">
                </td>
                <td style="font-size: 14px; padding: 5px; text-align: left;">
                    {{list.product_name}} {{list.cat_no}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: center; width: 100px;">{{list.qty}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: center; width: 100px;">{{list.dispatch_qty ?
                    list.dispatch_qty : 0 }}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 80px;">{{list.price}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 100px;"> {{list.sub_total}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: left; width: 120px;"> {{list.discount_amount *
                    list.qty| number:'1.0-3'}}({{list.discount_percent | number:'1.0-3' }}%)</td>
                <td style="font-size: 14px; padding: 5px; text-align: left; width: 120px;"> {{list.price -
                    list.discount_amount| number:'1.0-3'}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 110px;">{{list.amount}}
                </td>
            </tr>

        </table>


        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;">

            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Total Qty
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{totalOrderQty}}</td>
            </tr>

            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Sub
                    Amount</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.sub_total}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Discount
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_discount}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Net Total
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_total}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Grand
                    Total(Inclusive of GST)</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_grand_total}}</td>
            </tr>
            <tr>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000; border-bottom: 1px solid #000000;">
                    Breakup Of Grand Total</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000; border-bottom: 1px solid #000000;">
                    (&#8377;{{order_detail.netBreakup}},GST(18%)<br> : &#8377;{{order_detail.gstBreakup}}) </td>

            </tr>
        </table>
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;">

            <tr>
                <td
                    style="font-size: 14px; padding: 10px; text-align: left; border-left: 1px solid;border-right: 1px solid #000000; border-bottom: 1px solid #000000;">
                    Remarks:{{order_detail.order_remark ?order_detail.order_remark : 'No remark'}}</td>


            </tr>


        </table>


        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">

            <tr>

                <td style=" padding: 10px;">


                    <span style="margin: 2px; font-size: 14px; font-weight: 700; line-height: 28px;">
                        <b>Terms &amp; Conditions for Sale Order:</b></span>
                    <br style="color: rgb(85, 85, 85); font-family: Arial, Helvetica, sans-serif;">
                    <ol style="font-size: 14px ;margin-left: 20px;">
                        <li><span><b>Payment Terms:</b> If agreed payment terms are not followed by the parties then all
                                the pending orders can &nbsp;be preclosed by the company without any intimation.</span>
                        </li>
                        <li><span><b>Stock Availability: </b>&nbsp;The company is only liable to deliver the orders as
                                per stock availability.</span></li>
                        <li><span><b>Rates: </b>&nbsp;Company reserves all the rights to change the rates/discount
                                structure at any moment without any prior intimation.</span></li>
                        <li><span><b>Discount Structure:</b> All orders will be delivered on current discount structure
                                &nbsp;irrespective of price increases or decreases.</span></li>
                        <br>
                    </ol>
                </td>
            </tr>

        </table>




    </div>

</body>

</html>


<html id="printData" style="display:none" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <div style="width: 1024px; margin: 0 auto; font-family: Arial, Helvetica, sans-serif;">
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">
            <tr>
                <td style="vertical-align: top; padding: 5px; text-align: center;">
                    <div>

                        <img src="assets/img/logo.jpeg" alt="Logo" style="height: 70px;">
                    </div>
                </td>
                <td style="vertical-align: top; padding: 5px; text-align: right;" colspan="2">
                    <div>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Address:-</strong>28/3/2,
                            Site IV Industrial Area, Sahibabad, Ghaziabad, Uttar Pradesh 201001</p>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Contact Us:-</strong>+91-
                            86-87-300-400</p>
                        <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>E-Mail
                                Address:-</strong>info@gravitybath.com</p>
                    </div>
                </td>
            </tr>
            <tr>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline; ">
                        Order Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Date:-</strong>
                        {{order_detail.date_created | date :' dd/MM/yyyy'}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Order
                            ID:-</strong>{{order_detail.order_no}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Status:-</strong> Pending</p>


                </td>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline;">
                        Dealer Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Company Name & Type:-</strong>
                        {{order_detail.dr_name}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>GST
                            NO.:-</strong>{{order_detail.gst ? order_detail.gst : 'N/A'}}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;">
                        <strong>Address:-</strong>{{order_detail.address ? order_detail.address : 'N/A'}}
                        {{order_detail.city ? ', '+ order_detail.city : ''}} {{order_detail.district ? ',
                        '+order_detail.district : ''}} {{order_detail.state ? ', '+order_detail.state : ''}}</p>
                </td>
                <td style="vertical-align: top; padding: 5px;">
                    <h2
                        style="font-size: 14px; line-height: 20px; margin: 0px 0px 10px 0px; text-decoration: underline;">
                        Transport Detail</h2>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Transporter
                            Name:-</strong>{{!order_detail.transport_name ? ' N/A ' : order_detail.transport_name |
                        titlecase }}</p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Mobile
                            No:-</strong>{{!order_detail.transport_mobile ? ' N/A ' : order_detail.transport_mobile }}
                    </p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;">
                        <strong>Address:-</strong>{{!order_detail.transport_address ? ' N/A ' :
                        order_detail.transport_address | titlecase }} </p>
                    <p style="font-size: 14px; line-height: 20px; margin: 0px;"><strong>Private
                            Marka:-</strong>{{!order_detail.private_marka ? ' N/A ' : order_detail.private_marka |
                        titlecase }}</p>
                </td>
            </tr>
            <tr>
                <td colspan="3" style="padding:10px; background: #cccccc; font-size: 14px; font-weight: 600;">Order
                    Detail</td>
            </tr>
        </table>
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">

            <tr>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: left;">Product Description
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 60px;">QTY</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 100px;">Dispatch QTY.</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 80px;">Rate
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 100px;">Sub
                    Total</th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 120px;text-align: left;">Discount
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; width: 120px;text-align: left;">Net Rate
                </th>
                <th style="font-size: 14px; background: #f9f9f9; padding: 5px; text-align: right; width: 110px;">Amount
                </th>
            </tr>

            <tr *ngFor="let list of order_item; let i=index">


                <td style="font-size: 14px; padding: 5px; text-align: left;">
                    {{list.product_name}} {{list.cat_no}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: center; width: 100px;">{{list.qty}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: center; width: 100px;">{{list.dispatch_qty ?
                    list.dispatch_qty : 0 }}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 80px;">{{list.price}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 100px;"> {{list.sub_total}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: left; width: 120px;"> {{list.discount_amount *
                    list.qty| number:'1.0-3'}}({{list.discount_percent | number:'1.0-3' }}%)</td>
                <td style="font-size: 14px; padding: 5px; text-align: left; width: 120px;"> {{list.price -
                    list.discount_amount| number:'1.0-3'}}</td>
                <td style="font-size: 14px; padding: 5px; text-align: right; width: 110px;">{{list.amount}}
                </td>
            </tr>

        </table>


        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;">

            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Total Qty
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{totalOrderQty}}</td>
            </tr>

            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Sub
                    Amount</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.sub_total}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Discount
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_discount}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Net Total
                </td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_total}}</td>
            </tr>
            <tr>
                <td style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000;">Grand
                    Total(Inclusive of GST)</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000;">
                    {{order_detail.order_grand_total}}</td>
            </tr>
            <tr>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; border-left: 1px solid #000000; border-bottom: 1px solid #000000;">
                    Breakup Of Grand Total</td>
                <td
                    style="font-size: 14px; padding: 10px; text-align: right; width: 230px; border-right: 1px solid #000000; border-bottom: 1px solid #000000;">
                    (&#8377;{{order_detail.netBreakup}},GST(18%)<br> : &#8377;{{order_detail.gstBreakup}}) </td>

            </tr>
        </table>
        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;">

            <tr>
                <td
                    style="font-size: 14px; padding: 10px; text-align: left; border-left: 1px solid;border-right: 1px solid #000000; border-bottom: 1px solid #000000;">
                    Remarks:{{order_detail.order_remark ?order_detail.order_remark : 'No remark'}}</td>


            </tr>


        </table>


        <table
            style="width: 1024px; table-layout: fixed; box-sizing: border-box; table-layout: fixed; border-collapse: collapse;"
            border="1">

            <tr>

                <td style=" padding: 10px;">


                    <span style="margin: 2px; font-size: 14px; font-weight: 700; line-height: 28px;">
                        <b>Terms &amp; Conditions for Sale Order:</b></span>
                    <br style="color: rgb(85, 85, 85); font-family: Arial, Helvetica, sans-serif;">
                    <ol style="font-size: 14px ;margin-left: 20px;">
                        <li><span><b>Payment Terms:</b> If agreed payment terms are not followed by the parties then all
                                the pending orders can &nbsp;be preclosed by the company without any intimation.</span>
                        </li>
                        <li><span><b>Stock Availability: </b>&nbsp;The company is only liable to deliver the orders as
                                per stock availability.</span></li>
                        <li><span><b>Rates: </b>&nbsp;Company reserves all the rights to change the rates/discount
                                structure at any moment without any prior intimation.</span></li>
                        <li><span><b>Discount Structure:</b> All orders will be delivered on current discount structure
                                &nbsp;irrespective of price increases or decreases.</span></li>
                        <br>
                    </ol>
                </td>
            </tr>

        </table>




    </div>

</body>

</html>
